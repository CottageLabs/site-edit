In order to build your own version of EMLO-edit or IMPAcT-edit, you must first extract
the Aeolus framework software from https://github.com/BDLSS/Aeolus

About the Aeolus framework
==========================
The Aeolus Database Query system is a framework of PHP code and PostgreSQL tables and
database functions, originally developed for internal use at the Bodleian Library,
Oxford, UK, by Sushila Burgess. (At that stage, the acronym 'AEOLUS' stood for 'Answers
to Enquiries from Oxford Library Users and Staff'.) This framework provides: a login
page; pages to allow a supervisor to add and edit new users; a menu system;
functionality to allow any database table or view to be queried, with paginated
results, and with the ability to email query results to oneself as a CSV attachment.
You can build on the framework in different ways:
 * You can create your own SQL tables and then develop your own data entry forms and
   add these to the framework to allow editing of your database.
 * Alternatively, you can make use of two existing open-source repositories which
   build on the Aeolus framework: EMLO-edit and IMPAcT-edit. The database
   creation script provided in these two repositories sets up an entire suite of tables
   and database functions which can be used to handle literary catalogues.

About EMLO-edit and IMPAcT-edit
===============================

* 'EMLO' or 'Early Modern Letters Online' is a catalogue of 16th to 18th-century
  correspondence, primarily between early scientists, philosophers etc. Its parent
  project is called 'Cultures of Knowledge'; in fact the names 'EMLO' and 'Cultures
  of Knowledge' are often used interchangeably. Its editing interface is called
  'EMLO-edit', and is also known as the 'Union Catalogue' because it brings together
  multiple collections of records from different sources, united in one overall
  catalogue.

  The source code for EMLO-edit is available at https://github.com/BDLSS/EMLO-edit

* IMPAcT is a catalogue of 13th to 16th-century Islamic philosophy and theology.
  It uses the same source code as Cultures of Knowledge, with the addition of extra
  PHP classes for the handling of the Islamic lunar calendar and various features of
  medieval and early modern Islamic culture.

  The source code for the IMPAcT editing interface is now available at:
  https://github.com/BDLSS/IMPAcT-edit

* In order to install the EMLO-edit system, you need to extract:
  1. The basic Aeolus code from https://github.com/BDLSS/Aeolus
  2. The code specific to EMLO from https://github.com/BDLSS/EMLO-edit

* In order to install the IMPAcT system, you need to extract:
  1. The basic Aeolus code from https://github.com/BDLSS/Aeolus
  2. The code specific to EMLO from https://github.com/BDLSS/EMLO-edit
  3. The code specific to IMPAcT from https://github.com/BDLSS/IMPAcT-edit


Installing the EMLO or IMPAcT framework
=======================================
You need to have PostgreSQL 9 and PHP5 installed. Unfortunately we are still relying
on some deprecated settings. In the case of PostgreSQL, you need to have
'standard_conforming_strings' set to 'off'. In the case of PHP, we still use Pear::DB
which is no longer bundled with PHP, so you may need to install it. Then proceed as
follows:

1. * Extract everything from https://github.com/BDLSS/Aeolus.
     This needs to come FIRST.

   * Extract everything from https://github.com/BDLSS/EMLO-edit into the same
     directory. This needs to come SECOND, because two of the files from the core
     Aeolus framework (menu.php and html.php) need to be overwritten by ones specific
     to EMLO.

   * If you wish to install the IMPAcT system, thirdly extract everything from the
     IMPAcT source code repository, https://github.com/BDLSS/IMPAcT-edit, once again
     putting all the source code into the same directory as the previous two batches
     of code.

2. Edit private_defines.php

  * Change the settings of CONSTANT_LIVE_DATABASE_NAME, CONSTANT_TEST_DATABASE_NAME
    and CONSTANT_DEV_DATABASE_NAME to the database names that you want to use.

  * Change the setting of DB_LOGFILE_DIR to a directory which can be written to by
    your webserver daemon. Remember to make the path end in "/".

3. Edit the "launch" scripts which start up the chosen application:
    * For the main EMLO editing interface: 
       * union.php 
       * cardindex.php
       * optionally, dev_union.php and dev_cardindex.php if you want to set up a
         parallel 'development' version of the live database and source code
    * For the main IMPAcT editing interface: 
        * impact.php 
        * optionally dev_impact.php if you need a parallel 'development' version
    * For the offline data collection tool (currently only available for EMLO)
        * collect.php 
        * optionally dev_collect.php

   In all these "launch" scripts, set CONSTANT_SOURCEDIR to the directory where you
   have installed the source code. Remember to make the path end in "/".

4. Optionally, if you do not wish all your tables and usernames to begin with the
   prefix 'emlo' or 'impact', choose a different prefix and do a global search and
   replace in:

   * union.php, cardindex.php or impact.php (change the setting of CFG_PREFIX)

   * proj_defines_private.php (change the settings of CULTURES_OF_KNOWLEDGE_SYS_PREFIX
     and IMPACT_SYS_PREFIX)

   * For EMLO : create_emlo_all.sql (change the string 'emlo' throughout)
   * For IMPAcT: create_impact_all.sql (change the string 'impact' throughout)

   Similarly, if you do not wish the username of your main database administrator to
   end in 'a1supr', replace the string 'a1supr' in:

   * private_defines.php (change the setting of SUPERVISOR_ROLE_CODE)

   * For EMLO: create_emlo_all.sql (change the string 'a1supr' throughout)
   * For IMPAcT: create_impact_all.sql (change the string 'a1supr' throughout)

5. Edit proj_defines_private.php and set paths to directories into which your users
   may upload image files and CSV files (constants IMAGE_DIR_FOR_UPLOADS and
   CSV_DIR_FOR_UPLOADS). Please make sure that these are directories which your
   webserver daemon can write to. And as always with paths on the Aeolus system, make
   sure that the path ends in slash. Also change URLs in the same file as required.

6. Move the launch scripts (union.php, dev_union.php, cardindex.php, dev_cardindex.php,
   impact.php, dev_impact.php) into your Apache document root or other directory where
   Apache can serve them up.

7. Move all Javascript files (extension .js) and image files (extensions .png, .gif,
   .jpg) into the same directory where you put the launch scripts, i.e. into the
   Apache document root or similar.

8. If the database name that you defined in private_defines.php does not yet exist,
   create an empty database with that name now, as postgres, e.g.

   createdb -U postgres nameoflivedb

9. Run the appropriate database creation script as postgres against the database that
   you want to use:

   For EMLO: psql nameoflivedb -U postgres < create_emlo_all.sql
   For IMPAcT: psql nameoflivedb -U postgres < create_impact_all.sql

10. Visit the URL corresponding to the directory where you put your launch script,
    e.g. https://example.com/union.php, and log in with the following details:

   * Username: emloa1supr (EMLO)
           or: impacta1supr (IMPAcT)

   * Password: ChangeMeNowPlease!

   (Of course, if you have changed the system prefix from 'emlo/impact' and the
   supervisor role code from 'a1supr', then the username will be formed from your new
   settings. E.g. if your CFG_PREFIX is now 'shop' and SUPERVISOR_ROLE_CODE is now
   'manager', then the username will be 'shopmanager'.)

11. Change the password for the above user via the 'Edit your own details' option of
    the main menu.

12. Create further users as desired via 'Supervisor-only options' on the main menu.

13. !!! VERY IMPORTANT !!!
    Edit infrastructure.php and add your own logic for detecting cross-site scripting
    and for deciding if a method is 'safe', i.e. read-only and unable to change the
    database. (This step can be postponed, but MUST NOT be omitted, particularly when
    your new Aeolus system goes into production.)

14. If you wish to use the EMLO offline data collection tool, you will need to install
    OpenOffice and download a copy of the EMLOcollect OpenOffice Base application, so 
    that you can enter data in offline mode within the tool, and then upload the data
    into the database on your server. The EMLOcollect tool can be downloaded from:
    https://emlo-edit.bodleian.ox.ac.uk/culturesofknowledge/tool/EMLOcollect.odb

You can now proceed with your own development as described in the documentation that
will be made available on: https://damssupport.bodleian.ox.ac.uk/trac/aeolus

(Sushila Burgess, 12th June 2013)

0
